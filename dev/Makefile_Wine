export WINEARCH = win32
CC=wine ../jcc/jcc.exe
INCLUDE=-I../jcc/include
LINK=wine ../jcc/prelink.exe
LOBJS=../jcc/objs
RDRPREP=../rdrprep/rdrprep
HERCHOST=localhost
HERCPORT=3606

TARGET = hello.jcl
TARGETLIB=hello.out
SRCS = hello.c
OBJS := $(SRCS:%.c=%.obj)

all: $(TARGET)

$(TARGET): $(OBJS) link.jcl
	$(LINK) -s $(LOBJS) $(TARGETLIB) $(OBJS)
	$(RDRPREP) link.jcl $(TARGET)

hello.obj: hello.c
	$(CC) -o $(INCLUDE)  hello.c

install: $(TARGET)
	nc -w1 $(HERCHOST) $(HERCPORT) < $(TARGET)

clean:
	rm -f *.obj $(TARGETLIB) $(TARGET)